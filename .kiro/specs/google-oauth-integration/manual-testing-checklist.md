# Google OAuth 手动测试检查清单

## 概述

本文档提供了 Google OAuth 功能的手动测试检查清单，用于验证自动化测试无法覆盖的用户体验和交互流程。

---

## 测试前准备

### 测试账号
- [ ] 准备一个未注册的 Google 账号（测试新用户注册）
- [ ] 准备一个已注册的 Google 账号（测试老用户登录）
- [ ] 准备多个浏览器（Chrome, Firefox, Safari, Edge）
- [ ] 准备移动设备（iOS, Android）

### 测试环境
- [ ] 生产环境 URL: https://flux-ai-img.com
- [ ] 网络连接稳定
- [ ] 浏览器开发者工具已打开（用于性能测试）

---

## 1. 新用户注册流程 ✅

### 测试步骤

1. **访问首页**
   - [ ] 打开 https://flux-ai-img.com
   - [ ] 页面正常加载，无错误
   - [ ] 点击"登录"或"注册"按钮

2. **点击 Google 登录按钮**
   - [ ] Google 登录按钮显示正常
   - [ ] 按钮包含 Google 图标
   - [ ] 按钮文案清晰（根据当前语言）
   - [ ] 点击按钮

3. **Google 授权页面**
   - [ ] 在 500ms 内跳转到 Google 授权页面 ⏱️
   - [ ] 授权页面显示正确的应用名称
   - [ ] 显示请求的权限（email, profile）
   - [ ] 选择 Google 账号
   - [ ] 点击"允许"或"继续"

4. **返回应用**
   - [ ] 在 2 秒内返回应用 ⏱️
   - [ ] 显示加载动画
   - [ ] 自动完成登录

5. **登录成功**
   - [ ] 跳转到 `/create` 页面
   - [ ] 显示欢迎消息（包含用户姓名）
   - [ ] 用户信息正确显示（姓名、邮箱）
   - [ ] 积分余额显示为 3 积分 ✨
   - [ ] 整个流程 < 3 秒 ⏱️

### 性能测试

使用浏览器开发者工具的 Performance 面板：

1. **打开 Performance 面板**
   - [ ] 按 F12 打开开发者工具
   - [ ] 切换到 Performance 标签
   - [ ] 点击录制按钮

2. **执行登录流程**
   - [ ] 点击 Google 登录按钮
   - [ ] 完成整个登录流程
   - [ ] 停止录制

3. **分析性能**
   - [ ] 点击按钮 → Google 授权页面: < 500ms
   - [ ] Google 授权 → 回调处理: < 1s
   - [ ] 回调处理 → 登录完成: < 1s
   - [ ] 总计: < 3s

### 数据验证

1. **检查用户信息**
   - [ ] 用户姓名正确
   - [ ] 用户邮箱正确
   - [ ] 头像显示（如果有）

2. **检查积分**
   - [ ] 积分余额显示为 3
   - [ ] 可以查看积分历史
   - [ ] 显示注册赠送记录

---

## 2. 老用户登录流程 ✅

### 测试步骤

1. **使用已注册账号登录**
   - [ ] 访问 https://flux-ai-img.com
   - [ ] 点击 Google 登录
   - [ ] 选择已注册的 Google 账号
   - [ ] 授权（如果需要）

2. **登录成功**
   - [ ] 跳转到 `/create` 页面
   - [ ] 用户信息正确显示
   - [ ] 积分余额保持不变（不会重复赠送）
   - [ ] 可以查看历史记录

3. **功能验证**
   - [ ] 可以正常生成图片
   - [ ] 积分正确扣除
   - [ ] 历史记录正确显示

---

## 3. 登出流程 ✅

### 测试步骤

1. **登出**
   - [ ] 点击用户菜单
   - [ ] 点击"登出"按钮
   - [ ] 显示确认提示（如果有）

2. **登出成功**
   - [ ] 跳转到首页或登录页
   - [ ] 用户信息清除
   - [ ] 无法访问需要登录的页面

3. **重新登录**
   - [ ] 可以再次使用 Google 登录
   - [ ] 登录流程正常

---

## 4. 多语言支持测试 ✅

### 测试语言列表

对于每种语言，验证以下内容：

#### 主要语言（必测）

1. **英语 (en)**
   - [ ] URL: https://flux-ai-img.com/en
   - [ ] Google 登录按钮: "Sign in with Google"
   - [ ] 成功提示: "Welcome, [Name]!"
   - [ ] 错误提示正确

2. **简体中文 (zh)**
   - [ ] URL: https://flux-ai-img.com/zh
   - [ ] Google 登录按钮: "使用 Google 登录"
   - [ ] 成功提示: "欢迎，[姓名]！"
   - [ ] 错误提示正确

3. **繁体中文 (zh-TW)**
   - [ ] URL: https://flux-ai-img.com/zh-TW
   - [ ] Google 登录按钮: "使用 Google 登入"
   - [ ] 成功提示正确
   - [ ] 错误提示正确

4. **日语 (ja)**
   - [ ] URL: https://flux-ai-img.com/ja
   - [ ] Google 登录按钮: "Google でログイン"
   - [ ] 成功提示正确
   - [ ] 错误提示正确

5. **韩语 (ko)**
   - [ ] URL: https://flux-ai-img.com/ko
   - [ ] Google 登录按钮: "Google로 로그인"
   - [ ] 成功提示正确
   - [ ] 错误提示正确

#### 其他语言（抽样测试）

- [ ] 西班牙语 (es)
- [ ] 葡萄牙语 (pt)
- [ ] 德语 (de)
- [ ] 法语 (fr)
- [ ] 意大利语 (it)

### 验证内容

对于每种语言：
- [ ] Google 登录按钮文案正确
- [ ] 加载提示文案正确
- [ ] 成功提示文案正确
- [ ] 错误提示文案正确
- [ ] 页面其他文案正确

---

## 5. 错误处理测试 ✅

### 5.1 授权被拒绝

**测试步骤**:
1. [ ] 点击 Google 登录
2. [ ] 在 Google 授权页面点击"取消"或"拒绝"

**验证点**:
- [ ] 返回登录页面
- [ ] 显示友好的错误提示："授权被取消"或类似
- [ ] 不显示技术错误信息
- [ ] 可以重新尝试登录

### 5.2 网络错误

**测试步骤**:
1. [ ] 打开浏览器开发者工具
2. [ ] Network 标签 → Throttling → Offline
3. [ ] 尝试 Google 登录

**验证点**:
- [ ] 显示网络错误提示
- [ ] 提示用户检查网络连接
- [ ] 提供重试选项
- [ ] 恢复网络后可以正常登录

### 5.3 重复点击

**测试步骤**:
1. [ ] 点击 Google 登录按钮
2. [ ] 在跳转前快速多次点击

**验证点**:
- [ ] 按钮在点击后禁用
- [ ] 不会发起多次请求
- [ ] 只打开一个 Google 授权页面

### 5.4 邮箱冲突

**测试步骤**:
1. [ ] 使用邮箱密码注册一个账号
2. [ ] 使用相同邮箱的 Google 账号登录

**验证点**:
- [ ] 系统正确处理（合并账号或提示错误）
- [ ] 显示清晰的错误提示
- [ ] 建议用户使用密码登录或联系支持

---

## 6. 用户体验测试 ✅

### 6.1 加载状态

**验证点**:
- [ ] 点击 Google 登录后显示加载动画
- [ ] 加载动画流畅，无卡顿
- [ ] 按钮显示"加载中..."或类似文案
- [ ] 按钮禁用，防止重复点击

### 6.2 成功提示

**验证点**:
- [ ] 登录成功后显示欢迎消息
- [ ] 提示包含用户姓名
- [ ] 提示样式友好（不是突兀的弹窗）
- [ ] 提示自动消失（3-5 秒）

### 6.3 错误提示

**验证点**:
- [ ] 错误提示清晰明确
- [ ] 提示包含解决建议
- [ ] 提示样式友好（不是红色警告框）
- [ ] 提示可以手动关闭

### 6.4 响应式设计

**桌面浏览器**:
- [ ] Chrome: Google 登录按钮正常显示
- [ ] Firefox: Google 登录按钮正常显示
- [ ] Safari: Google 登录按钮正常显示
- [ ] Edge: Google 登录按钮正常显示

**平板设备**:
- [ ] iPad: 登录流程流畅
- [ ] Android 平板: 登录流程流畅

**移动设备**:
- [ ] iPhone: 登录流程流畅
- [ ] Android 手机: 登录流程流畅
- [ ] 小屏幕设备: 按钮大小合适，易于点击

---

## 7. 回归测试 ✅

确保 Google OAuth 不影响现有功能。

### 7.1 邮箱密码登录

**验证点**:
- [ ] 邮箱密码注册仍然正常
- [ ] 邮箱密码登录仍然正常
- [ ] 两种登录方式可以共存
- [ ] 可以在登录页面切换登录方式

### 7.2 图片生成功能

**验证点**:
- [ ] 登录后可以访问 `/create` 页面
- [ ] 可以正常生成图片
- [ ] 积分正确扣除
- [ ] 生成历史正确记录
- [ ] 可以下载生成的图片

### 7.3 积分系统

**验证点**:
- [ ] 积分余额正确显示
- [ ] 可以查看积分历史
- [ ] 积分购买功能正常
- [ ] 积分交易记录正确

### 7.4 用户设置

**验证点**:
- [ ] 可以访问用户设置页面
- [ ] 可以修改用户信息
- [ ] 可以查看账号绑定信息
- [ ] 可以解绑 Google 账号（如果支持）

---

## 8. 安全测试 ✅

### 8.1 HTTPS 验证

**验证点**:
- [ ] 所有页面使用 HTTPS
- [ ] 浏览器地址栏显示锁图标
- [ ] SSL 证书有效
- [ ] 无混合内容警告

### 8.2 Token 安全

**验证点**:
- [ ] JWT token 不在 URL 中暴露
- [ ] Token 存储在安全位置（HttpOnly cookie 或 localStorage）
- [ ] 登出后 token 失效
- [ ] 无法使用过期 token

### 8.3 隐私保护

**验证点**:
- [ ] 不在控制台输出敏感信息
- [ ] 不在网络请求中暴露密码
- [ ] Google token 不在前端暴露
- [ ] 用户数据加密传输

---

## 9. 边缘场景测试 ✅

### 9.1 慢网络

**测试步骤**:
1. [ ] 使用浏览器开发者工具模拟慢网络（Slow 3G）
2. [ ] 尝试 Google 登录

**验证点**:
- [ ] 显示加载状态
- [ ] 不会超时（或超时时间合理）
- [ ] 最终可以成功登录

### 9.2 浏览器返回

**测试步骤**:
1. [ ] 点击 Google 登录
2. [ ] 在 Google 授权页面点击浏览器返回按钮

**验证点**:
- [ ] 返回登录页面
- [ ] 页面状态正常
- [ ] 可以重新尝试登录

### 9.3 多标签页

**测试步骤**:
1. [ ] 在标签页 A 登录
2. [ ] 在标签页 B 刷新页面

**验证点**:
- [ ] 标签页 B 也显示已登录状态
- [ ] 用户信息同步
- [ ] 积分余额同步

### 9.4 长时间未操作

**测试步骤**:
1. [ ] 登录后等待 30 分钟（或更长）
2. [ ] 尝试生成图片或其他操作

**验证点**:
- [ ] Session 仍然有效（或提示重新登录）
- [ ] 重新登录流程流畅
- [ ] 不会丢失数据

---

## 10. 可访问性测试 ✅

### 10.1 键盘导航

**验证点**:
- [ ] 可以使用 Tab 键导航到 Google 登录按钮
- [ ] 可以使用 Enter 键触发登录
- [ ] 焦点样式清晰可见
- [ ] 键盘导航顺序合理

### 10.2 屏幕阅读器

**验证点**:
- [ ] Google 登录按钮有正确的 aria-label
- [ ] 加载状态有 aria-live 提示
- [ ] 错误提示可以被屏幕阅读器读取
- [ ] 成功提示可以被屏幕阅读器读取

### 10.3 颜色对比度

**验证点**:
- [ ] Google 登录按钮文字清晰可读
- [ ] 错误提示颜色对比度足够
- [ ] 成功提示颜色对比度足够
- [ ] 符合 WCAG 2.1 AA 标准

---

## 测试报告

### 测试信息

- **测试日期**: ___________
- **测试人员**: ___________
- **测试环境**: 生产环境
- **浏览器**: ___________
- **设备**: ___________

### 测试结果

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 新用户注册 | ☐ | ☐ | |
| 老用户登录 | ☐ | ☐ | |
| 登出流程 | ☐ | ☐ | |
| 多语言支持 | ☐ | ☐ | |
| 错误处理 | ☐ | ☐ | |
| 用户体验 | ☐ | ☐ | |
| 回归测试 | ☐ | ☐ | |
| 安全测试 | ☐ | ☐ | |
| 边缘场景 | ☐ | ☐ | |
| 可访问性 | ☐ | ☐ | |

### 性能指标

- Google 授权页面打开时间: _____ ms
- 授权完成到登录成功: _____ ms
- 整个登录流程: _____ ms

### 发现的问题

1. **问题描述**: 
   - **严重程度**: ☐ 高 ☐ 中 ☐ 低
   - **复现步骤**: 
   - **截图**: 

2. **问题描述**: 
   - **严重程度**: ☐ 高 ☐ 中 ☐ 低
   - **复现步骤**: 
   - **截图**: 

### 测试结论

- [ ] ✅ 所有测试通过，可以发布
- [ ] ⚠️ 部分测试失败，需要修复
- [ ] ❌ 重大问题，不建议发布

### 签名

测试人员: ___________  
日期: ___________

---

**最后更新**: 2024-12-23  
**版本**: 1.0  
**状态**: ✅ 手动测试检查清单
